<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Pro Sidebar Template</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background-color: #111827;
            color: #9ca3af;
            height: 100vh;
            overflow: hidden;
        }

        .sidebar {
            position: relative;
            display: flex;
            flex-direction: column;
            flex-grow: 1;
            gap: 1.25rem;
            overflow-y: auto;
            border-right: 1px solid rgba(255, 255, 255, 0.1);
            background-color: #111827;
            padding: 0 1.5rem;
            width: 280px;
            height: 100vh;
        }

        .sidebar::before {
            content: '';
            pointer-events: none;
            position: absolute;
            inset: 0;
            background-color: rgba(0, 0, 0, 0.1);
        }

        .header {
            position: relative;
            display: flex;
            flex-direction: row;
            height: 4rem;
            flex-shrink: 0;
            align-items: center;
            gap: 0.75rem;
        }

        .logo {
            height: 2rem;
            width: auto;
        }

        .app-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #ffffff;
            text-align: center;
            letter-spacing: -0.025em;
        }

        .section-title {
            font-size: 0.75rem;
            font-weight: 600;
            color: #6b7280;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 0.5rem;
            padding: 0 0.5rem;
        }

        .nav-section+.nav-section {
            margin-top: 2rem;
        }

        .nav {
            position: relative;
            display: flex;
            flex: 1;
            flex-direction: column;
        }

        .nav-list {
            display: flex;
            flex: 1;
            flex-direction: column;
            gap: 1.75rem;
            list-style: none;
        }

        .nav-section {
            list-style: none;
        }

        .nav-items {
            margin: 0 -0.5rem;
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
            list-style: none;
        }

        .nav-item {
            list-style: none;
        }

        .nav-link {
            display: flex;
            gap: 0.75rem;
            border-radius: 0.375rem;
            padding: 0.5rem;
            font-size: 0.875rem;
            line-height: 1.5rem;
            font-weight: 600;
            color: #9ca3af;
            text-decoration: none;
            transition: all 0.15s ease-in-out;
        }

        .nav-link:hover {
            background-color: rgba(255, 255, 255, 0.05);
            color: #ffffff;
        }

        .nav-link.active {
            background-color: rgba(255, 255, 255, 0.05);
            color: #ffffff;
        }

        .nav-button {
            display: flex;
            width: 100%;
            align-items: center;
            gap: 0.75rem;
            border-radius: 0.375rem;
            padding: 0.5rem;
            text-align: left;
            font-size: 0.875rem;
            line-height: 1.5rem;
            font-weight: 600;
            color: #9ca3af;
            background: none;
            border: none;
            cursor: pointer;
            transition: all 0.15s ease-in-out;
        }

        .nav-button:hover {
            background-color: rgba(255, 255, 255, 0.05);
            color: #ffffff;
        }

        .nav-icon {
            width: 1.5rem;
            height: 1.5rem;
            flex-shrink: 0;
            color: currentColor;
        }

        .chevron-icon {
            margin-left: auto;
            width: 1.25rem;
            height: 1.25rem;
            flex-shrink: 0;
            color: #9ca3af;
            transition: transform 0.15s ease-in-out;
        }

        .nav-button[aria-expanded="true"] .chevron-icon {
            transform: rotate(90deg);
            color: #9ca3af;
        }

        .submenu {
            margin-top: 0.25rem;
            padding: 0 0.5rem;
            display: none;
        }

        .submenu.show {
            display: block;
        }

        .submenu-list {
            list-style: none;
        }

        .submenu-item {
            list-style: none;
        }

        .submenu-link {
            display: block;
            border-radius: 0.375rem;
            padding: 0.5rem 0.5rem 0.5rem 2.25rem;
            font-size: 0.875rem;
            line-height: 1.5rem;
            color: #9ca3af;
            text-decoration: none;
            transition: all 0.15s ease-in-out;
        }

        .submenu-link:hover {
            background-color: rgba(255, 255, 255, 0.05);
            color: #ffffff;
        }

        .profile-section {
            margin: 0 -1.5rem;
            margin-top: auto;
            position: sticky;
            bottom: 0;
            background-color: #111827;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            padding: 1rem 1.5rem;
        }

        .profile-container {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 1rem;
        }

        .profile-info {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            flex: 1;
        }

        .profile-avatar {
            width: 2.5rem;
            height: 2.5rem;
            border-radius: 50%;
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
            font-weight: 700;
            color: #ffffff;
            outline: 2px solid rgba(255, 255, 255, 0.1);
            outline-offset: -1px;
        }

        .profile-details {
            display: flex;
            flex-direction: column;
            gap: 0.125rem;
        }

        .profile-name {
            font-size: 0.875rem;
            font-weight: 600;
            color: #ffffff;
        }

        .profile-role {
            font-size: 0.75rem;
            color: #9ca3af;
        }

        .logout-button {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 2rem;
            height: 2rem;
            border-radius: 0.375rem;
            background: none;
            border: none;
            color: #9ca3af;
            cursor: pointer;
            transition: all 0.15s ease-in-out;
        }

        .logout-button:hover {
            background-color: rgba(255, 255, 255, 0.05);
            color: #ffffff;
        }

        .logout-icon {
            width: 1.25rem;
            height: 1.25rem;
        }

        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        /* Responsive design */
        @media (max-width: 768px) {
            .sidebar {
                width: 100%;
                max-width: 320px;
            }
        }
    </style>
</head>

<body>
    <div class="sidebar">
        <div class="header">
            <svg fill="#ffffff" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" stroke="#ffffff" class="logo">
                <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                <g id="SVGRepo_iconCarrier">
                    <title>ionicons-v5_logos</title>
                    <path d="M126.12,315.1A47.06,47.06,0,1,1,79.06,268h47.06Z"></path>
                    <path d="M149.84,315.1a47.06,47.06,0,0,1,94.12,0V432.94a47.06,47.06,0,1,1-94.12,0Z"></path>
                    <path d="M196.9,126.12A47.06,47.06,0,1,1,244,79.06v47.06Z"></path>
                    <path d="M196.9,149.84a47.06,47.06,0,0,1,0,94.12H79.06a47.06,47.06,0,0,1,0-94.12Z"></path>
                    <path d="M385.88,196.9A47.06,47.06,0,1,1,432.94,244H385.88Z"></path>
                    <path d="M362.16,196.9a47.06,47.06,0,0,1-94.12,0V79.06a47.06,47.06,0,1,1,94.12,0Z"></path>
                    <path d="M315.1,385.88A47.06,47.06,0,1,1,268,432.94V385.88Z"></path>
                    <path d="M315.1,362.16a47.06,47.06,0,0,1,0-94.12H432.94a47.06,47.06,0,1,1,0,94.12Z"></path>
                </g>
            </svg>
            <h1 class="app-title">CMR Pulse</h1>
        </div>
        <nav class="nav">
            <ul class="nav-list">
                <!-- Main Section -->
                <li class="nav-section">
                    <div class="section-title">Main</div>
                    <ul class="nav-items">
                         <li class="nav-item">
                             <a href="javascript:void(0)" onclick="navigateToForm('Dashboard')" class="nav-link active" data-form="Dashboard">
                                 <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"
                                     class="nav-icon" aria-hidden="true">
                                     <path
                                         d="m2.25 12 8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25"
                                         stroke-linecap="round" stroke-linejoin="round" />
                                 </svg>
                                 Dashboard
                             </a>
                         </li>
                        <li class="nav-item">
                            <a href="javascript:void(0)" onclick="navigateToForm('ReportGenerator')" class="nav-link" data-form="ReportGenerator">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"
                                    class="nav-icon" aria-hidden="true">
                                    <path d="M10.5 6a7.5 7.5 0 1 0 7.5 7.5h-7.5V6Z" stroke-linecap="round"
                                        stroke-linejoin="round" />
                                    <path d="M13.5 10.5H21A7.5 7.5 0 0 0 13.5 3v7.5Z" stroke-linecap="round"
                                        stroke-linejoin="round" />
                                </svg>
                                Report Generator
                            </a>
                        </li>
                        <li class="nav-item">
                            <button type="button" class="nav-button" aria-expanded="false" data-submenu="settings">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"
                                    class="nav-icon" aria-hidden="true">
                                    <path
                                        d="M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.325.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 0 1 1.37.49l1.296 2.247a1.125 1.125 0 0 1-.26 1.431l-1.003.827c-.293.241-.438.613-.43.992a6.759 6.759 0 0 1 0 .255c-.008.378.137.75.43.991l1.004.827c.424.35.534.955.26 1.43l-1.298 2.247a1.125 1.125 0 0 1-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 0 1-.22.128c-.331.183-.581.495-.644.869l-.213 1.281c-.09.543-.56.94-1.11.94h-2.594c-.55 0-1.019-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 0 1-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 0 1-1.369-.49l-1.297-2.247a1.125 1.125 0 0 1 .26-1.431l1.004-.827c.292-.24.437-.613.43-.991a6.932 6.932 0 0 1 0-.255c.007-.38-.138-.751-.43-.992l-1.004-.827a1.125 1.125 0 0 1-.26-1.43l1.297-2.247a1.125 1.125 0 0 1 1.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.086.22-.128.332-.183.582-.495.644-.869l.214-1.28Z"
                                        stroke-linecap="round" stroke-linejoin="round" />
                                    <path d="M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" stroke-linecap="round"
                                        stroke-linejoin="round" />
                                </svg>
                                Settings
                                <svg viewBox="0 0 20 20" fill="currentColor" class="chevron-icon" aria-hidden="true">
                                    <path
                                        d="M8.22 5.22a.75.75 0 0 1 1.06 0l4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.75.75 0 0 1-1.06-1.06L11.94 10 8.22 6.28a.75.75 0 0 1 0-1.06Z"
                                        clip-rule="evenodd" fill-rule="evenodd" />
                                </svg>
                            </button>
                            <div class="submenu" id="settings">
                                <ul class="submenu-list">
                                    <li class="submenu-item">
                                        <a href="javascript:void(0)" onclick="navigateToForm('Admin')" class="submenu-link" data-form="Admin">Admin</a>
                                    </li>
                                    <li class="submenu-item">
                                        <a href="javascript:void(0)" onclick="navigateToForm('Users')" class="submenu-link" data-form="Users">Users</a>
                                    </li>
                                </ul>
                            </div>
                        </li>
                    </ul>
                </li>

                <!-- Useful Links Section -->
                <li class="nav-section">
                    <div class="section-title">Useful Links</div>
                    <ul class="nav-items">
                         <li class="nav-item">
                             <a href="javascript:void(0)" onclick="openExternalUrl('https://cmr-hub.company.com')" class="nav-link">
                                 <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"
                                     class="nav-icon" aria-hidden="true">
                                     <path
                                         d="M13.19 8.688a4.5 4.5 0 0 1 1.242 7.244l-4.5 4.5a4.5 4.5 0 0 1-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5 0 0 0-6.364-6.364l-4.5 4.5a4.5 4.5 0 0 0 1.242 7.244"
                                         stroke-linecap="round" stroke-linejoin="round" />
                                 </svg>
                                 CMR Hub
                             </a>
                         </li>
                         <li class="nav-item">
                             <a href="javascript:void(0)" onclick="openExternalUrl('https://cp-nam.company.com')" class="nav-link">
                                 <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"
                                     class="nav-icon" aria-hidden="true">
                                     <path
                                         d="M12 21a9.004 9.004 0 0 0 8.716-6.747M12 21a9.004 9.004 0 0 1-8.716-6.747M12 21c2.485 0 4.5-4.03 4.5-9S14.485 3 12 3m0 18c-2.485 0-4.5-4.03-4.5-9S9.515 3 12 3m0 0a8.997 8.997 0 0 1 7.843 4.582M12 3a8.997 8.997 0 0 0-7.843 4.582m15.686 0A11.953 11.953 0 0 1 12 10.5c-2.998 0-5.74-1.1-7.843-2.918m15.686 0A8.959 8.959 0 0 1 21 12c0 .778-.099 1.533-.284 2.253m0 0A17.919 17.919 0 0 1 12 16.5c-3.162 0-6.133-.815-8.716-2.247m0 0A9.015 9.015 0 0 1 3 12c0-1.605.42-3.113 1.157-4.418"
                                         stroke-linecap="round" stroke-linejoin="round" />
                                 </svg>
                                 CP NAM
                             </a>
                         </li>
                         <li class="nav-item">
                             <a href="javascript:void(0)" onclick="openExternalUrl('https://cp-emea.company.com')" class="nav-link">
                                 <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"
                                     class="nav-icon" aria-hidden="true">
                                     <path
                                         d="M12 21a9.004 9.004 0 0 0 8.716-6.747M12 21a9.004 9.004 0 0 1-8.716-6.747M12 21c2.485 0 4.5-4.03 4.5-9S14.485 3 12 3m0 18c-2.485 0-4.5-4.03-4.5-9S9.515 3 12 3m0 0a8.997 8.997 0 0 1 7.843 4.582M12 3a8.997 8.997 0 0 0-7.843 4.582m15.686 0A11.953 11.953 0 0 1 12 10.5c-2.998 0-5.74-1.1-7.843-2.918m15.686 0A8.959 8.959 0 0 1 21 12c0 .778-.099 1.533-.284 2.253m0 0A17.919 17.919 0 0 1 12 16.5c-3.162 0-6.133-.815-8.716-2.247m0 0A9.015 9.015 0 0 1 3 12c0-1.605.42-3.113 1.157-4.418"
                                         stroke-linecap="round" stroke-linejoin="round" />
                                 </svg>
                                 CP EMEA
                             </a>
                         </li>
                         <li class="nav-item">
                             <a href="javascript:void(0)" onclick="openExternalUrl('https://cp-apac.company.com')" class="nav-link">
                                 <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"
                                     class="nav-icon" aria-hidden="true">
                                     <path
                                         d="M12 21a9.004 9.004 0 0 0 8.716-6.747M12 21a9.004 9.004 0 0 1-8.716-6.747M12 21c2.485 0 4.5-4.03 4.5-9S14.485 3 12 3m0 18c-2.485 0-4.5-4.03-4.5-9S9.515 3 12 3m0 0a8.997 8.997 0 0 1 7.843 4.582M12 3a8.997 8.997 0 0 0-7.843 4.582m15.686 0A11.953 11.953 0 0 1 12 10.5c-2.998 0-5.74-1.1-7.843-2.918m15.686 0A8.959 8.959 0 0 1 21 12c0 .778-.099 1.533-.284 2.253m0 0A17.919 17.919 0 0 1 12 16.5c-3.162 0-6.133-.815-8.716-2.247m0 0A9.015 9.015 0 0 1 3 12c0-1.605.42-3.113 1.157-4.418"
                                         stroke-linecap="round" stroke-linejoin="round" />
                                 </svg>
                                 CP APAC
                             </a>
                         </li>
                         <li class="nav-item">
                             <a href="javascript:void(0)" onclick="openExternalUrl('https://credit-approval.company.com')" class="nav-link">
                                 <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"
                                     class="nav-icon" aria-hidden="true">
                                     <path d="M3.75 13.5l10.5-11.25L12 10.5h8.25L9.75 21.75 12 13.5H3.75z"
                                         stroke-linecap="round" stroke-linejoin="round" />
                                 </svg>
                                 Credit Approval Accelerator
                             </a>
                         </li>
                         <li class="nav-item">
                             <a href="javascript:void(0)" onclick="openExternalUrl('https://onesource.company.com')" class="nav-link">
                                 <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"
                                     class="nav-icon" aria-hidden="true">
                                     <path
                                         d="M20.25 6.375c0 2.278-3.694 4.125-8.25 4.125S3.75 8.653 3.75 6.375m16.5 0c0-2.278-3.694-4.125-8.25-4.125S3.75 4.097 3.75 6.375m16.5 0v11.25c0 2.278-3.694 4.125-8.25 4.125s-8.25-1.847-8.25-4.125V6.375m16.5 0v3.75m-16.5-3.75v3.75m16.5 0v3.75C20.25 16.153 16.556 18 12 18s-8.25-1.847-8.25-4.125v-3.75m16.5 0c0 2.278-3.694 4.125-8.25 4.125s-8.25-1.847-8.25-4.125"
                                         stroke-linecap="round" stroke-linejoin="round" />
                                 </svg>
                                 One Source
                             </a>
                         </li>
                    </ul>
                </li>

                <!-- Help Section -->
                <li class="nav-section">
                    <div class="section-title">Help</div>
                    <ul class="nav-items">
                         <li class="nav-item">
                             <a href="javascript:void(0)" onclick="openHelpEmail()" class="nav-link">
                                 <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"
                                     class="nav-icon" aria-hidden="true">
                                     <path
                                         d="M9.879 7.519c0-1.072.859-1.94 1.94-1.94s1.94.868 1.94 1.94-.859 1.94-1.94 1.94-1.94-.868-1.94-1.94ZM12 15.75v-6"
                                         stroke-linecap="round" stroke-linejoin="round" />
                                     <path d="M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" stroke-linecap="round"
                                         stroke-linejoin="round" />
                                 </svg>
                                 Help & Support
                             </a>
                         </li>
                    </ul>
                </li>
                <li class="profile-section">
                    <div class="profile-container">
                        <div class="profile-info">
                            <div class="profile-avatar">
                                TC
                            </div>
                            <div class="profile-details">
                                <div class="profile-name">Tom Cook</div>
                                <div class="profile-role">Administrator</div>
                            </div>
                        </div>
                        <button class="logout-button" onclick="logout()" title="Log Out">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"
                                class="logout-icon" aria-hidden="true">
                                <path
                                    d="M15.75 9V5.25A2.25 2.25 0 0 0 13.5 3h-6a2.25 2.25 0 0 0-2.25 2.25v13.5A2.25 2.25 0 0 0 7.5 21h6a2.25 2.25 0 0 0 2.25-2.25V15M12 9l-3 3m0 0 3 3m-3-3h12.75"
                                    stroke-linecap="round" stroke-linejoin="round" />
                            </svg>
                        </button>
                    </div>
                </li>
            </ul>
        </nav>
    </div>

    <script>
        // Initialize dropdown functionality
        document.addEventListener('DOMContentLoaded', function () {
            const dropdownButtons = document.querySelectorAll('.nav-button[data-submenu]');

            dropdownButtons.forEach(button => {
                button.addEventListener('click', function () {
                    const submenuId = this.getAttribute('data-submenu');
                    const submenu = document.getElementById(submenuId);
                    const isExpanded = this.getAttribute('aria-expanded') === 'true';

                    // Close all other submenus
                    dropdownButtons.forEach(otherButton => {
                        if (otherButton !== this) {
                            const otherSubmenuId = otherButton.getAttribute('data-submenu');
                            const otherSubmenu = document.getElementById(otherSubmenuId);
                            otherButton.setAttribute('aria-expanded', 'false');
                            otherSubmenu.classList.remove('show');
                        }
                    });

                    // Toggle current submenu
                    if (isExpanded) {
                        this.setAttribute('aria-expanded', 'false');
                        submenu.classList.remove('show');
                    } else {
                        this.setAttribute('aria-expanded', 'true');
                        submenu.classList.add('show');
                    }
                });
            });

             // Handle navigation link clicks
             const navLinks = document.querySelectorAll('.nav-link:not(.profile-link)');
             navLinks.forEach(link => {
                 link.addEventListener('click', function (e) {
                     e.preventDefault();

                     // Remove active class from all nav links and submenu links
                     navLinks.forEach(navLink => {
                         navLink.classList.remove('active');
                     });
                     document.querySelectorAll('.submenu-link').forEach(submenuLink => {
                         submenuLink.classList.remove('active');
                     });

                     // Add active class to clicked link
                     this.classList.add('active');

                     // If this link has a form navigation, handle it
                     const formName = this.getAttribute('data-form');
                     if (formName && typeof window.navigateToForm === 'function') {
                         window.navigateToForm(formName);
                     }
                 });
             });

            // Handle submenu link clicks
            const submenuLinks = document.querySelectorAll('.submenu-link');
            submenuLinks.forEach(link => {
                link.addEventListener('click', function (e) {
                    e.preventDefault();

                    // Remove active class from all nav links
                    navLinks.forEach(navLink => {
                        navLink.classList.remove('active');
                    });

                    // Remove active class from all submenu links
                    submenuLinks.forEach(submenuLink => {
                        submenuLink.classList.remove('active');
                    });

                    // Add active class to clicked submenu link
                    this.classList.add('active');

                    // If this link has a form navigation, handle it
                    const formName = this.getAttribute('data-form');
                    if (formName && typeof window.navigateToForm === 'function') {
                        window.navigateToForm(formName);
                    }
                });
            });

             // Logout function
             window.logout = function () {
                 try {
                     // Method 1: Call VBA logout handler
                     if (typeof window.external !== 'undefined' && window.external.CallFromWebView) {
                         window.external.CallFromWebView('LOGOUT', '');
                         return;
                     }
                     
                     // Method 2: Direct VBA call
                     if (typeof window.external !== 'undefined' && window.external.HandleLogout) {
                         window.external.HandleLogout();
                         return;
                     }
                     
                     // Silent fallback - no messages
                     console.log('Logout called - VBA integration required');
                     
                 } catch (e) {
                     console.error('Logout error:', e);
                 }
             };

             // Function to navigate to different forms in MS Access
             window.navigateToForm = function(formName) {
                 try {
                     // Method 1: Direct VBA function call (if exposed)
                     if (typeof window.external !== 'undefined' && window.external.NavigateToForm) {
                         window.external.NavigateToForm(formName);
                         return;
                     }
                     
                     // Method 2: Call through generic VBA interface
                     if (typeof window.external !== 'undefined' && window.external.CallFromWebView) {
                         window.external.CallFromWebView('NAVIGATE', formName);
                         return;
                     }
                     
                     // Method 3: Alternative VBA call method
                     if (typeof window.external !== 'undefined') {
                         window.external.CallVBAFunction('NavigateToForm', formName);
                         return;
                     }
                     
                     // Method 4: Try Chrome/Edge specific method
                     if (window.chrome && window.chrome.webview) {
                         window.chrome.webview.postMessage({
                             action: 'navigate',
                             formName: formName
                         });
                         return;
                     }
                     
                     // Silent fallback - just log to console
                     console.log('Navigate to form: ' + formName);
                     
                 } catch (e) {
                     console.error('Navigation error:', e);
                 }
             };

             // MS Access compatible function to open external URLs
             window.openExternalUrl = function(url) {
                 try {
                     // Try MS Access method first
                     if (typeof window.external !== 'undefined' && window.external.Navigate) {
                         window.external.Navigate(url);
                     }
                     // Fallback to standard methods
                     else if (window.open) {
                         window.open(url, '_blank');
                     }
                     else {
                         window.location.href = url;
                     }
                 } catch (e) {
                     // Silent fallback
                     try {
                         window.location.href = url;
                     } catch (err) {
                         console.error('Unable to open link: ' + url, err);
                     }
                 }
             };

             // Function to open Outlook with pre-populated email
             window.openHelpEmail = function() {
                 var recipient = 'support@company.com';
                 var ccRecipient = 'it-helpdesk@company.com';
                 var subject = 'CMR Pulse - Help Request';
                 var body = 'Dear Support Team,%0D%0A%0D%0A' +
                           'I need assistance with CMR Pulse application.%0D%0A%0D%0A' +
                           'Issue Description:%0D%0A' +
                           '[Please describe your issue here]%0D%0A%0D%0A' +
                           'User: ' + (document.querySelector('.profile-name') ? document.querySelector('.profile-name').textContent : 'Current User') + '%0D%0A' +
                           'Date: ' + new Date().toLocaleDateString() + '%0D%0A' +
                           'Time: ' + new Date().toLocaleTimeString() + '%0D%0A%0D%0A' +
                           'Thank you for your assistance.%0D%0A%0D%0A' +
                           'Best regards';
                 
                 var mailtoLink = 'mailto:' + recipient + 
                                 '?cc=' + ccRecipient +
                                 '&subject=' + encodeURIComponent(subject) +
                                 '&body=' + body;
                 
                 try {
                     // Try MS Access method first
                     if (typeof window.external !== 'undefined' && window.external.Navigate) {
                         window.external.Navigate(mailtoLink);
                     }
                     // Fallback to standard method
                     else {
                         window.location.href = mailtoLink;
                     }
                 } catch (e) {
                     // Silent fallback
                     try {
                         window.location.href = mailtoLink;
                     } catch (err) {
                         console.error('Unable to open email client', err);
                     }
                 }
             };
         });
    </script>
</body>

</html>
