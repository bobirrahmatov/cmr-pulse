<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Credit Management Reporting Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .dashboard {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            opacity: 0.9;
            font-size: 1.1rem;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            padding: 30px;
            background: #f8f9fa;
        }

        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            text-align: center;
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .stat-label {
            color: #6c757d;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .controls {
            padding: 30px;
            background: white;
            border-bottom: 1px solid #e9ecef;
        }

        .controls-row {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            align-items: center;
            margin-bottom: 20px;
        }

        .search-box {
            flex: 1;
            min-width: 300px;
            position: relative;
        }

        .search-box input {
            width: 100%;
            padding: 12px 45px 12px 15px;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .search-box input:focus {
            outline: none;
            border-color: #2a5298;
        }

        .search-icon {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #6c757d;
        }

        .filter-group {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .filter-select {
            padding: 10px 15px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            background: white;
            cursor: pointer;
            transition: border-color 0.3s ease;
        }

        .filter-select:focus {
            outline: none;
            border-color: #2a5298;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .btn-success {
            background: linear-gradient(135deg, #56ab2f 0%, #a8e6cf 100%);
            color: white;
        }

        .btn-warning {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }

        .btn-info {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .bulk-actions {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .reports-table {
            overflow-x: auto;
            margin: 0 30px 30px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
        }

        th {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        td {
            padding: 15px;
            border-bottom: 1px solid #e9ecef;
            vertical-align: middle;
        }

        tr:hover {
            background: #f8f9fa;
        }

        .status-badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .status-sent {
            background: #d4edda;
            color: #155724;
        }

        .status-pending {
            background: #fff3cd;
            color: #856404;
        }

        .status-overdue {
            background: #f8d7da;
            color: #721c24;
        }

        .priority-high {
            color: #dc3545;
            font-weight: 700;
        }

        .priority-medium {
            color: #fd7e14;
            font-weight: 600;
        }

        .priority-low {
            color: #28a745;
            font-weight: 500;
        }

        .action-buttons {
            display: flex;
            gap: 8px;
        }

        .btn-sm {
            padding: 8px 12px;
            font-size: 0.8rem;
        }

        .checkbox {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            margin: 20px 0;
        }

        .pagination button {
            padding: 8px 12px;
            border: 1px solid #dee2e6;
            background: white;
            cursor: pointer;
            border-radius: 5px;
        }

        .pagination button.active {
            background: #2a5298;
            color: white;
            border-color: #2a5298;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
        }

        .modal-content {
            background: white;
            margin: 5% auto;
            padding: 30px;
            border-radius: 15px;
            width: 90%;
            max-width: 600px;
            position: relative;
        }

        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            position: absolute;
            right: 20px;
            top: 15px;
        }

        .close:hover {
            color: black;
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: #e9ecef;
            border-radius: 10px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(135deg, #56ab2f 0%, #a8e6cf 100%);
            transition: width 0.3s ease;
        }

        @media (max-width: 768px) {
            .controls-row {
                flex-direction: column;
            }
            
            .search-box {
                min-width: 100%;
            }
            
            .bulk-actions {
                width: 100%;
                justify-content: center;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
        }

        .loading {
            display: none;
            text-align: center;
            padding: 20px;
            color: #6c757d;
        }

        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #2a5298;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 0 auto 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="dashboard">
        <div class="header">
            <h1>Credit Management Reporting Dashboard</h1>
            <p>Comprehensive report tracking and generation system</p>
        </div>

        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-number" style="color: #28a745;" id="totalReports">80</div>
                <div class="stat-label">Total Reports</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" style="color: #dc3545;" id="pendingReports">27</div>
                <div class="stat-label">Pending Reports</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" style="color: #28a745;" id="sentReports">53</div>
                <div class="stat-label">Sent Reports</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" style="color: #fd7e14;" id="overdueReports">8</div>
                <div class="stat-label">Overdue Reports</div>
            </div>
        </div>

        <div class="controls">
            <div class="controls-row">
                <div class="search-box">
                    <input type="text" id="searchInput" placeholder="Search reports by name, department, or type...">
                    <span class="search-icon">üîç</span>
                </div>
                
                <div class="filter-group">
                    <select class="filter-select" id="statusFilter">
                        <option value="">All Status</option>
                        <option value="pending">Pending</option>
                        <option value="sent">Sent</option>
                        <option value="overdue">Overdue</option>
                    </select>
                    
                    <select class="filter-select" id="priorityFilter">
                        <option value="">All Priority</option>
                        <option value="high">High</option>
                        <option value="medium">Medium</option>
                        <option value="low">Low</option>
                    </select>
                    
                    <select class="filter-select" id="departmentFilter">
                        <option value="">All Departments</option>
                        <option value="Risk Management">Risk Management</option>
                        <option value="Credit Analysis">Credit Analysis</option>
                        <option value="Collections">Collections</option>
                        <option value="Executive">Executive</option>
                    </select>
                </div>
            </div>

            <div class="controls-row">
                <div class="bulk-actions">
                    <button class="btn btn-success" onclick="generateSelectedReports()">
                        üìä Generate Selected
                    </button>
                    <button class="btn btn-primary" onclick="sendSelectedReports()">
                        üìß Send Selected
                    </button>
                    <button class="btn btn-info" onclick="scheduleReports()">
                        ‚è∞ Schedule Reports
                    </button>
                    <button class="btn btn-warning" onclick="exportReports()">
                        üì• Export Data
                    </button>
                    <button class="btn btn-secondary" onclick="refreshDashboard()">
                        üîÑ Refresh
                    </button>
                </div>
                
                <div style="margin-left: auto;">
                    <span id="selectedCount">0 selected</span>
                </div>
            </div>
        </div>

        <div class="loading" id="loadingIndicator">
            <div class="spinner"></div>
            <div>Processing reports...</div>
        </div>

        <div class="reports-table">
            <table id="reportsTable">
                <thead>
                    <tr>
                        <th><input type="checkbox" id="selectAll" class="checkbox"></th>
                        <th>Report Name</th>
                        <th>Department</th>
                        <th>Priority</th>
                        <th>Status</th>
                        <th>Last Sent</th>
                        <th>Next Due</th>
                        <th>Recipients</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="reportsTableBody">
                </tbody>
            </table>
        </div>

        <div class="pagination" id="pagination"></div>
    </div>

    <!-- Modal for Report Generation Progress -->
    <div id="progressModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Generating Reports</h2>
            <div id="progressContainer">
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill" style="width: 0%"></div>
                </div>
                <div id="progressText">Starting generation...</div>
            </div>
        </div>
    </div>

    <!-- Modal for Scheduling -->
    <div id="scheduleModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Schedule Reports</h2>
            <div style="margin: 20px 0;">
                <label>Schedule Type:</label><br>
                <select style="width: 100%; padding: 10px; margin: 10px 0; border: 1px solid #ddd; border-radius: 5px;">
                    <option>One Time</option>
                    <option>Daily</option>
                    <option>Weekly</option>
                    <option>Monthly</option>
                </select>
                
                <label>Date & Time:</label><br>
                <input type="datetime-local" style="width: 100%; padding: 10px; margin: 10px 0; border: 1px solid #ddd; border-radius: 5px;">
                
                <button class="btn btn-primary" style="width: 100%; margin-top: 15px;">Schedule Selected Reports</button>
            </div>
        </div>
    </div>

    <script>
        // Sample data for 80 reports
        const reports = [];
        const reportTypes = [
            'Daily Credit Risk Summary', 'Weekly Portfolio Analysis', 'Monthly Delinquency Report',
            'Credit Exposure Analysis', 'Risk Rating Distribution', 'Collections Performance',
            'Payment Behavior Analysis', 'Credit Limit Utilization', 'Industry Sector Risk',
            'Geographic Risk Distribution', 'Vintage Analysis Report', 'Loss Given Default',
            'Recovery Rate Analysis', 'Credit Score Migration', 'Covenant Compliance',
            'Watchlist Monitoring', 'Early Warning Indicators', 'Credit Committee Report'
        ];
        
        const frequencies = ['Daily', 'Weekly', 'Monthly', 'Quarterly'];
        const priorities = ['High', 'Medium', 'Low'];
        const departments = ['Risk Management', 'Credit Analysis', 'Collections', 'Executive'];
        
        // Initialize reports data
        for (let i = 0; i < 80; i++) {
            const isOverdue = Math.random() < 0.1;
            const isPending = Math.random() < 0.34;
            let status = 'sent';
            
            if (isOverdue) status = 'overdue';
            else if (isPending) status = 'pending';
            
            reports.push({
                id: i + 1,
                name: `${reportTypes[i % reportTypes.length]} ${Math.floor(i / reportTypes.length) + 1}`,
                frequency: frequencies[i % frequencies.length],
                priority: priorities[i % priorities.length].toLowerCase(),
                department: departments[i % departments.length],
                lastSent: status === 'sent' ? new Date(Date.now() - Math.random() * 7 * 24 * 60 * 60 * 1000) : null,
                nextDue: new Date(Date.now() + Math.random() * 7 * 24 * 60 * 60 * 1000),
                status: status,
                recipients: Math.floor(Math.random() * 15) + 1,
                selected: false
            });
        }

        let filteredReports = [...reports];
        let currentPage = 1;
        const reportsPerPage = 15;

        // Initialize dashboard
        function initDashboard() {
            updateStats();
            renderReports();
            setupEventListeners();
        }

        function updateStats() {
            const totalReports = reports.length;
            const pendingReports = reports.filter(r => r.status === 'pending').length;
            const sentReports = reports.filter(r => r.status === 'sent').length;
            const overdueReports = reports.filter(r => r.status === 'overdue').length;
            
            document.getElementById('totalReports').textContent = totalReports;
            document.getElementById('pendingReports').textContent = pendingReports;
            document.getElementById('sentReports').textContent = sentReports;
            document.getElementById('overdueReports').textContent = overdueReports;
        }

        function renderReports() {
            const tbody = document.getElementById('reportsTableBody');
            const startIndex = (currentPage - 1) * reportsPerPage;
            const endIndex = startIndex + reportsPerPage;
            const pageReports = filteredReports.slice(startIndex, endIndex);
            
            tbody.innerHTML = pageReports.map(report => `
                <tr>
                    <td><input type="checkbox" class="checkbox report-checkbox" data-id="${report.id}" ${report.selected ? 'checked' : ''}></td>
                    <td><strong>${report.name}</strong><br><small>${report.frequency}</small></td>
                    <td>${report.department}</td>
                    <td><span class="priority-${report.priority}">${report.priority.toUpperCase()}</span></td>
                    <td><span class="status-badge status-${report.status}">${report.status.toUpperCase()}</span></td>
                    <td>${report.lastSent ? report.lastSent.toLocaleDateString() : 'Never'}</td>
                    <td>${report.nextDue.toLocaleDateString()}</td>
                    <td>${report.recipients} users</td>
                    <td>
                        <div class="action-buttons">
                            <button class="btn btn-success btn-sm" onclick="generateSingleReport(${report.id})" ${report.status === 'sent' ? 'style="opacity:0.6"' : ''}>
                                üìä Generate
                            </button>
                            <button class="btn btn-primary btn-sm" onclick="sendSingleReport(${report.id})" ${report.status === 'pending' ? 'disabled' : ''}>
                                üìß Send
                            </button>
                            <button class="btn btn-info btn-sm" onclick="viewReportDetails(${report.id})">
                                üëÅÔ∏è View
                            </button>
                        </div>
                    </td>
                </tr>
            `).join('');
            
            renderPagination();
            updateSelectedCount();
        }

        function renderPagination() {
            const totalPages = Math.ceil(filteredReports.length / reportsPerPage);
            const pagination = document.getElementById('pagination');
            
            pagination.innerHTML = `
                <button onclick="changePage(${currentPage - 1})" ${currentPage === 1 ? 'disabled' : ''}>Previous</button>
                ${Array.from({length: Math.min(totalPages, 7)}, (_, i) => {
                    const page = i + 1;
                    return `<button onclick="changePage(${page})" class="${page === currentPage ? 'active' : ''}">${page}</button>`;
                }).join('')}
                <button onclick="changePage(${currentPage + 1})" ${currentPage === totalPages ? 'disabled' : ''}>Next</button>
            `;
        }

        function setupEventListeners() {
            // Search functionality
            document.getElementById('searchInput').addEventListener('input', filterReports);
            
            // Filter functionality
            document.getElementById('statusFilter').addEventListener('change', filterReports);
            document.getElementById('priorityFilter').addEventListener('change', filterReports);
            document.getElementById('departmentFilter').addEventListener('change', filterReports);
            
            // Select all checkbox
            document.getElementById('selectAll').addEventListener('change', function() {
                const checkboxes = document.querySelectorAll('.report-checkbox');
                checkboxes.forEach(cb => {
                    cb.checked = this.checked;
                    const reportId = parseInt(cb.dataset.id);
                    const report = reports.find(r => r.id === reportId);
                    if (report) report.selected = this.checked;
                });
                updateSelectedCount();
            });
            
            // Individual checkboxes
            document.addEventListener('change', function(e) {
                if (e.target.classList.contains('report-checkbox')) {
                    const reportId = parseInt(e.target.dataset.id);
                    const report = reports.find(r => r.id === reportId);
                    if (report) report.selected = e.target.checked;
                    updateSelectedCount();
                }
            });
            
            // Modal close functionality
            document.querySelectorAll('.close').forEach(closeBtn => {
                closeBtn.addEventListener('click', function() {
                    this.closest('.modal').style.display = 'none';
                });
            });
        }

        function filterReports() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const statusFilter = document.getElementById('statusFilter').value;
            const priorityFilter = document.getElementById('priorityFilter').value;
            const departmentFilter = document.getElementById('departmentFilter').value;
            
            filteredReports = reports.filter(report => {
                const matchesSearch = report.name.toLowerCase().includes(searchTerm) || 
                                    report.department.toLowerCase().includes(searchTerm);
                const matchesStatus = !statusFilter || report.status === statusFilter;
                const matchesPriority = !priorityFilter || report.priority === priorityFilter;
                const matchesDepartment = !departmentFilter || report.department === departmentFilter;
                
                return matchesSearch && matchesStatus && matchesPriority && matchesDepartment;
            });
            
            currentPage = 1;
            renderReports();
        }

        function changePage(page) {
            const totalPages = Math.ceil(filteredReports.length / reportsPerPage);
            if (page >= 1 && page <= totalPages) {
                currentPage = page;
                renderReports();
            }
        }

        function updateSelectedCount() {
            const selectedCount = reports.filter(r => r.selected).length;
            document.getElementById('selectedCount').textContent = `${selectedCount} selected`;
        }

        // Action functions
        function generateSelectedReports() {
            const selectedReports = reports.filter(r => r.selected);
            if (selectedReports.length === 0) {
                alert('Please select reports to generate.');
                return;
            }
            
            showProgressModal();
            simulateReportGeneration(selectedReports);
        }

        function generateSingleReport(id) {
            const report = reports.find(r => r.id === id);
            if (report) {
                showProgressModal();
                simulateReportGeneration([report]);
            }
        }

        function sendSelectedReports() {
            const selectedReports = reports.filter(r => r.selected && r.status !== 'pending');
            if (selectedReports.length === 0) {
                alert('Please select generated reports to send.');
                return;
            }
            
            selectedReports.forEach(report => {
                report.status = 'sent';
                report.lastSent = new Date();
                report.selected = false;
            });
            
            updateStats();
            renderReports();
            alert(`${selectedReports.length} reports sent successfully!`);
        }

        function sendSingleReport(id) {
            const report = reports.find(r => r.id === id);
            if (report && report.status !== 'pending') {
                report.status = 'sent';
                report.lastSent = new Date();
                updateStats();
                renderReports();
                alert('Report sent successfully!');
            }
        }

        function scheduleReports() {
            const selectedReports = reports.filter(r => r.selected);
            if (selectedReports.length === 0) {
                alert('Please select reports to schedule.');
                return;
            }
            
            document.getElementById('scheduleModal').style.display = 'block';
        }

        function exportReports() {
            const csvContent = "data:text/csv;charset=utf-8," + 
                "Report Name,Department,Priority,Status,Last Sent,Next Due,Recipients\n" +
                reports.map(r => 
                    `"${r.name}","${r.department}","${r.priority}","${r.status}","${r.lastSent ? r.lastSent.toISOString() : 'Never'}","${r.nextDue.toISOString()}","${r.recipients}"`
                ).join("\n");
            
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", "credit_reports_export.csv");
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        function refreshDashboard() {
            document.getElementById('loadingIndicator').style.display = 'block';
            document.querySelector('.reports-table').style.display = 'none';
            
            setTimeout(() => {
                // Simulate refresh
                updateStats();
                renderReports();
                document.getElementById('loadingIndicator').style.display = 'none';
                document.querySelector('.reports-table').style.display = 'block';
            }, 2000);
        }

        function viewReportDetails(id) {
            const report = reports.find(r => r.id === id);
            if (report) {
                alert(`Report Details:\n\nName: ${report.name}\nDepartment: ${report.department}\nPriority: ${report.priority}\nStatus: ${report.status}\nFrequency: ${report.frequency}\nRecipients: ${report.recipients}`);
            }
        }

        function showProgressModal() {
            document.getElementById('progressModal').style.display = 'block';
        }

        function simulateReportGeneration(selectedReports) {
            const modal = document.getElementById('progressModal');
            const progressFill = document.getElementById('progressFill');
            const progressText = document.getElementById('progressText');
            
            let progress = 0;
            const totalReports = selectedReports.length;
            let completedReports = 0;
            
            const interval = setInterval(() => {
                progress += Math.random() * 15;
                if (progress > (completedReports + 1) * (100 / totalReports)) {
                    progress = (completedReports + 1) * (100 / totalReports);
                }
                
                progressFill.style.width = progress + '%';
                progressText.textContent = `Generating report ${completedReports + 1} of ${totalReports}... ${Math.round(progress)}%`;
                
                if (progress >= (completedReports + 1) * (100 / totalReports)) {
                    completedReports++;
                    selectedReports[completedReports - 1].status = 'sent';
                    selectedReports[completedReports - 1].lastSent = new Date();
                    selectedReports[completedReports - 1].selected = false;
                }
                
                if (completedReports >= totalReports) {
                    clearInterval(interval);
                    progressText.textContent = 'All reports generated successfully!';
                    
                    setTimeout(() => {
                        modal.style.display = 'none';
                        updateStats();
                        renderReports();
                        progressFill.style.width = '0%';
                    }, 1500);
                }
            }, 200);
        }

        // Initialize dashboard on load
        document.addEventListener('DOMContentLoaded', initDashboard);
    </script>
</body>
</html>
